<!DOCTYPE html>
<html class="rwd geo-override  vis no-rtl headerfooter-menu3  js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage no-websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients no-cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers no-applicationcache svg inlinesvg smil svgclippaths" lang="en" style="--wm-toolbar-height: 67px;"><head><script src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/athena.js" type="text/javascript"></script><link type="text/css" rel="stylesheet" id="dark-mode-general-link"><link type="text/css" rel="stylesheet" id="dark-mode-custom-link"><style lang="en" type="text/css" id="dark-mode-custom-style"></style><style lang="en" type="text/css" id="dark-mode-native-style"></style><style lang="en" type="text/css" id="dark-mode-native-sheet"></style>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app218.us.archive.org';v.server_ms=292;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/bundle-playback.js" charset="utf-8"></script>
<script type="text/javascript" src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/wombat.js" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden","showSwfDownload":true};</script>
<script type="text/javascript" src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/ruffle.js"></script>
<script type="text/javascript">
    __wm.init("https://web.archive.org/web");
  __wm.wombat("https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","20200917044707","https://web.archive.org/","web","https://web-static.archive.org/_static/",
	      "1600318027");
</script>
<link rel="stylesheet" type="text/css" href="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->

    <meta charset="UTF-8">
    





<title>API without Secrets: Introduction to Vulkan* Part 5</title>
    








    <script type="text/javascript" src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/performance-config.js"></script>

<link rel="preconnect" href="https://web.archive.org/web/20200917044707/https://dpm.demdex.net/" crossorigin="">
<link rel="dns-prefetch" href="https://web.archive.org/web/20200917044707/https://dpm.demdex.net/">
<link rel="preconnect" href="https://web.archive.org/web/20200917044707/https://starget.intel.com/">
<link rel="dns-prefetch" href="https://web.archive.org/web/20200917044707/https://starget.intel.com/">
<link rel="preconnect" href="https://web.archive.org/web/20200917044707/https://a.idio.co/" crossorigin="">
<link rel="dns-prefetch" href="https://web.archive.org/web/20200917044707/https://a.idio.co/">
<link rel="preconnect" href="https://web.archive.org/web/20200917044707/https://s334284386.t.eloqua.com/">
<link rel="dns-prefetch" href="https://web.archive.org/web/20200917044707/https://s334284386.t.eloqua.com/">
<link rel="dns-prefetch" href="https://web.archive.org/web/20200917044707/https://onsite2.researchintel.com/">
<link rel="preconnect" href="https://web.archive.org/web/20200917044707/https://tags.tiqcdn.com/" crossorigin="">
<link rel="dns-prefetch" href="https://web.archive.org/web/20200917044707/https://tags.tiqcdn.com/">
<link rel="preconnect" href="https://web.archive.org/web/20200917044707/https://www91.intel.com/">
<link rel="dns-prefetch" href="https://web.archive.org/web/20200917044707/https://www91.intel.com/">

    














<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<!--[if lte IE 9]>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<![endif]-->


    <meta name="keywords" content="Game Dev">

    <meta name="description" content="In this part of the tutorial we will focus on improving performance. At the same time, we will prepare for the next tutorial, in which we introduce images and descriptors (shader resources). Using the knowledge we gather here, it will be easier for us to follow the next part and squeeze as much performance as possible from our graphics hardware.">

    <meta name="language" content="en">

    <meta name="location" content="us">

    <meta name="robots" content="follow,index,noarchive">

    <meta name="X-Server" content="INTE-T1">


    <meta property="og:image" content="https://web.archive.org/web/20200917044707im_/https://www.intel.com/content/dam/develop/external/us/en/images/vulkan-part-4-image-01-result-of-rendering-673812.png">

    <meta property="og:type" content="company">

    <meta property="og:site_name" content="Intel">

    <meta property="og:title" content="API without Secrets: Introduction to Vulkan* Part 5">

    <meta property="fb:admins" content="267985180046218">

    <meta property="og:url" content="https://web.archive.org/web/20200917044707/https://www.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html">

    <meta property="og:description" content="In this part of the tutorial we will focus on improving performance. At the same time, we will prepare for the next tutorial, in which we introduce images and descriptors (shader resources). Using the knowledge we gather here, it will be easier for us to follow the next part and squeeze as much performance as possible from our graphics hardware.">

<meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <meta name="emtcontenttype" content="Content Type|Web Pages|Articles;">

    <meta name="contentpath" content="/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-5">

    <meta name="authoreddate" content="2016-08-12T14:14:39.000-07:00">

    <meta name="emttechnology" content="Technology|Third-Party Technologies|Vulkan*;Technology|Intel® Technologies|Intel® Graphics and Visual Technologies;">

    <meta name="localecode" content="en_US">

    <meta name="mime" content="text/html">

    <meta name="format" content="editorialpost">

    <meta name="excludefromviews" content="false">

    <meta name="taxonomy" content="etm-0d937c50068349bfa1e24d64b9a17db7;etm-678e0660d7864aa29cadc065a34d8ec9;etm-1b1627b1502a4090908800edf123071c;">

    <meta name="title" content="API without Secrets: Introduction to Vulkan* Part 5">

    <meta name="menu" content="Game Development">

    <meta name="emtsubject" content="Subject|Information Technology (IT)|Visual Computing|Video Game Development;">

    <meta name="reimaginefilters" content="Technology|Third-Party Technologies|Vulkan*;Technology|Intel® Technologies|Intel® Graphics and Visual Technologies;Subject|Information Technology (IT)|Visual Computing|Video Game Development;">

    <meta name="generic1" content="true">

    <meta name="emtaudience" content="Audience|Business|Business Technology Solution Specialist (BTSS)|Software Developer;">

    <meta name="intelkeywords" content="Game Dev">

    <meta name="lastModifieddate" content="2016-08-12T00:00:00.000-07:00">

    <meta name="thumbnailurl" content="https://software.intel.com/content/dam/develop/external/us/en/images/vulkan-part-4-image-01-result-of-rendering-673812.png">


    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    





<link rel="icon" type="image/png" sizes="32x32" href="https://web.archive.org/web/20200917044707im_/https://software.intel.com/etc.clientlibs/settings/wcm/designs/intel/default/resources/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://web.archive.org/web/20200917044707im_/https://software.intel.com/etc.clientlibs/settings/wcm/designs/intel/default/resources/favicon-16x16.png">
<link rel="shortcut icon" href="https://web.archive.org/web/20200917044707im_/https://software.intel.com/etc.clientlibs/settings/wcm/designs/intel/default/resources/favicon.ico">
    





<link rel="canonical" href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html">
    

    <style>@-ms-viewport{width:device-width;}</style>
    
        
        
            
                
                
                    <link rel="stylesheet" href="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/intc-core.min.css" type="text/css"><script src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/intc-core.min.js" defer="defer"></script>
                    
                
            
        
    
<script src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/clipboard.min.js"></script><style>:is([id*='google_ads_iframe'],[id*='taboola-'],.taboolaHeight,.taboola-placeholder,#top-ad,#credential_picker_container,#credentials-picker-container,#credential_picker_iframe,[id*='google-one-tap-iframe'],#google-one-tap-popup-container,.google-one-tap__module,.google-one-tap-modal-div,#amp_floatingAdDiv,#ez-content-blocker-container) {display:none!important;min-height:0!important;height:0!important;}</style><script>var isTargetEnabled =false;</script><script>var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
let window = _____WB$wombat$assign$function_____("window");
let globalThis = _____WB$wombat$assign$function_____("globalThis");
let self = _____WB$wombat$assign$function_____("self");
let document = _____WB$wombat$assign$function_____("document");
let location = _____WB$wombat$assign$function_____("location");
let top = _____WB$wombat$assign$function_____("top");
let parent = _____WB$wombat$assign$function_____("parent");
let frames = _____WB$wombat$assign$function_____("frames");
let opener = _____WB$wombat$assign$function_____("opener");
{
var cq_tms = {
        wa_emtcontenttype: "emtcontenttype:webpage/article",
        wa_emttechnology: "emttechnology:inteltechnologies/intelgraphicsandvisualtechnologies,emttechnology:thirdpartytechnologies/vulkan",
        wa_emtsubject: "emtsubject:itinformationtechnology/visualcomputing/videogamedevelopment",
        
        wa_industry_type: "",
        wa_partner_prog: "",
        wa_subject: "emtsubject:itinformationtechnology/visualcomputing/videogamedevelopment",
        wa_biz_size: "",
        wa_emt_org: "",
        wa_emt_intel: "",
        wa_partner_type: "",
        wa_programidentifier: "",
        wa_location: "us",
        wa_language: "en",
        wa_english_title: "API without Secrets: Introduction to Vulkan* Part 5",
        wa_content_type: "article",
        wa_intel_platform: "",
        wa_applications: "",
        wa_local: "en_US",
        wa_intel_technology: "emttechnology:inteltechnologies/intelgraphicsandvisualtechnologies,emttechnology:thirdpartytechnologies/vulkan",
        wa_system_type: "",
        wa_product_name: "",
        wa_audience: "emtaudience:business/btssbusinesstechnologysolutionspecialist/softwaredeveloper",
        wa_life_cycle: "",
        wa_cq_url: "/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html",
        wa_page_type_micro: "editorialposttemplate",
        wa_env: "prd",
        wa_cq_pub_env: "publish",
        wa_transl_status: "",
        wa_product_id: "",
        wa_software: "",
        wa_reference_design: "",
        wa_codename: "",
        wa_created_date: "1587983862719",
        wa_modifed_date: "1586858330952",
        wa_off_time: "1633704899026",
        wa_ownedby: "",
        wa_managedby: "",
        wa_idz_nid : "673812",
        wa_event_type: "",
        wa_idz_custom_tags: "",
        wa_programming_language: "",
        wa_skill_level: "",
        wa_solution: "",
        wa_product_formFactor: "",
        wa_operating_system: "",
        wa_marketing_products: "",
        wa_ssg_third_party_prod_sys_sol: "",
        
        wa_secondary_content_type: ""
    };
    
    
    
    cq_tms.wa_tms_sync_load = "deferred";

}}</script><script>var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
let window = _____WB$wombat$assign$function_____("window");
let globalThis = _____WB$wombat$assign$function_____("globalThis");
let self = _____WB$wombat$assign$function_____("self");
let document = _____WB$wombat$assign$function_____("document");
let location = _____WB$wombat$assign$function_____("location");
let top = _____WB$wombat$assign$function_____("top");
let parent = _____WB$wombat$assign$function_____("parent");
let frames = _____WB$wombat$assign$function_____("frames");
let opener = _____WB$wombat$assign$function_____("opener");
{
!function(){var e=setInterval(function(){"undefined"!=typeof $CQ&&($CQ(function(){CQ_Analytics.SegmentMgr.loadSegments("/etc/segmentation"),CQ_Analytics.ClientContextUtils.init("/etc/clientcontext/intel",window.location.pathname.substr(0,window.location.pathname.indexOf(".")))}),clearInterval(e))},100)}();

}}</script><link rel="stylesheet" type="text/css" href="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/commons-page.min.css"><link rel="stylesheet" type="text/css" href="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/intel.rwd.override.css"></head>



















    



    




<body class="page-is-published simplified-header"><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr; height: 67px;" toolbar-mode="auto">
</div><div id="wm-ipp-print">The Wayback Machine - 
https://web.archive.org/web/20200917044707/https://software.intel.com/
content/www/us/en/develop/articles/api-without-secrets-introduction-to-
vulkan-part-5.html</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(750,27,25,2,"web","https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","20200917044707",1996,"https://web-static.archive.org/_static/",["https://web-static.archive.org/_static/css/banner-styles.css?v=p7PEIJWi","https://web-static.archive.org/_static/css/iconochive.css?v=3PDvdIFv"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 

<div class="promo-banner-content"></div>

























<script>
    var isLoggedin = (location.protocol == 'https:' && document.cookie.indexOf('SMSESSION') != -1);
    var loginValidateURL = 'https://web.archive.org/web/20200917044707/https://www.intel.com/libs/apps/intel/myintel/profile.html/validate/loggedin';
</script>




    
    
        
        
            



























    
    
        
    



    
    
        <div class="header-simplify component" data-component="header" data-component-id="1">
            <header role="banner">
                <span visibility="hidden"></span>
                <div class="site-mask" data-igm-site-mask=""></div>
                <nav class="global-menu-simplify navbar-fixed-top " role="navigation" aria-label="Site" data-igm="">
                    <div class="container main-navbar">
                        <div class="row">
                            <div class="nav-left col-xs-5 mobileFirst">
                                <div class="content">
                                    <button class="hamburger icon hidden-md hidden-lg hidden-xl" data-toggle="mega-menu" data-target="#menu-products"><span class="fa-menu"></span>
                                    </button>
                                    <ul class="hidden-xs hidden-sm">
                                        
                                            <li>
                                                <button data-toggle="mega-menu" data-target="#menu-0">Products</button>
                                            </li>
                                        
                                            <li>
                                                <button data-toggle="mega-menu" data-target="#menu-1">Support</button>
                                            </li>
                                        
                                            <li>
                                                <button data-toggle="mega-menu" data-target="#menu-2">Solutions</button>
                                            </li>
                                        
                                    </ul>
                                </div>
                            </div>

                            <div class="nav-center col-xs-2">
                                <div class="content">
                                    <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/homepage.html" alt="Intel homepage" class="navbar-logo" title="Intel Logo"></a>
                                </div>
                            </div>

                            <div class="nav-right col-xs-5">
                                <div class="content">
                                    
                                        <button type="button" class="language-selector-toggle mobileFirst" aria-label="USA (English)" data-igm-search-toggle="">
                                    <span class="hidden-xs" aria-hidden="true">
                                        USA (English)
                                    </span>
                                            <span class="icon fa-globe align-icons"></span>
                                        </button>
                                    

                                    <span class="states-login">
                            <span class="state-logged-in state-option">
                            <span class="option-links" id="myprofile-signin-menu"></span>

                            </span>
                                    </span>
                                    <button class="login login-toggle item icon mobileFirst" aria-label="Sign In" data-igm-search-toggle="">
                                <span class="login-label" aria-hidden="true"> Sign In </span><span class="icon-login align-icons fa-"></span></button>
                                    
                                <span role="search">
                                    <button type="button" title="Search" class="search-button icon mobileFirst" data-igm-search-toggle=""><span class="fa-search" id="newsearch"></span></button>
                                </span>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="uheadersearch homepagesearch">
























    










    















    
    
    
        
    


    <div id="simplify-search" class="search-content brand-darkest-gray theme-dark-1 component mobileFirst" data-component="homepagesearch" data-igm-search-content="" data-component-id="1">
        <div class="wrapper-outer-sticky-footer">
            <div class="wrapper-sticky-footer">
                <div class="slide-search-results">
                    <form class="search item" data-igm-search-control="" name="hpsform-new" id="hpsform-new" action="/web/20200917044707/https://software.intel.com/content/www/us/en/search.html" onsubmit="return INTEL_TYPE_AHEAD.onSubmitHps('Search', '/content/www/us/en', 'en_US')">
                        <button type="submit" class="search-button icon" aria-label="Search" data-tabindex="2"><span class="fa-search"></span></button>
                        
                            
                            
                                <label for="mobile-search">
                                    <input id="toplevelcategory" name="toplevelcategory" type="hidden" value="none">
                                    <input id="query" name="query" type="hidden" value="">
                                    <input data-tabindex="1" data-search-input="" id="mobile-search" name="keyword" type="text" data-igm-search-input="" title="Search" autocomplete="off" placeholder="Search Intel.com">
                                </label>
                            
                        
                        <button id="header-btn-clear" type="clear" class="search-clear" data-igm-search-clear="">
                            <span></span></button>
                        <button type="button" id="cls-btn" class="close icon" aria-label="Close" data-igm-search-toggle="" data-tabindex="3"><span></span></button>
                    </form>
                    <div class="search-quick-links hidden" data-component="wa_skip_track" data-component-id="1">
                        <div class="overlay-content quick-links-terms">
                            <h3>Quick Links</h3>
                            <p>Try these quick links to visit popular site sections</p>
                            <ul>
                                <li>
                                    <a class="quick-link" rel="noopener noreferrer" href="https://web.archive.org/web/20200917044707/https://downloadcenter.intel.com/?wapkw=quicklink:download-center">
                                        Download Center
                                    </a>
                                </li>
                                <li>
                                    <a class="quick-link" rel="noopener noreferrer" href="https://web.archive.org/web/20200917044707/https://ark.intel.com/?wapkw=quicklink:product-specifications">
                                        Product Specifications
                                    </a>
                                </li>
                                <li>
                                    <a class="quick-link" rel="noopener noreferrer" href="https://web.archive.org/web/20200917044707/https://www.intel.com/content/www/us/en/products/devices-systems.html?wapkw=quicklink:products">
                                        Products
                                    </a>
                                </li>
                                <li><a class="quick-link" rel="noopener noreferrer" href="https://web.archive.org/web/20200917044707/https://www.intel.com/content/www/us/en/support.html?wapkw=quicklink:support">
                                    Support
                                </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="results-overlay results-recent results component" data-component="wa_skip_track" data-component-id="1">
                        <div class="overlay-content recent-searches-terms">
                            <h3>Recent Searches</h3>
                        </div>
                    </div>
                </div>
                <div class="slide-language-selector">
                    <div class="modal-intel language-selector modal-expose-menu" id="modal-language-selector">
                    </div>
                    













<script type="text/javascript">
    var languageslectorexists = false;
</script>

    <script type="text/javascript">
        languageslectorexists = true;

    </script>
    <!-- MODAL for Language selector -->
    <script id="gls-template" type="text/x-handlebars-template">
        <div class="language-selector-block">
            <div class="modal-content flyout-panel-block force-background" role="dialog"
                 aria-labelledby="regionselector" aria-describedby="selectregion">
                <div class="modal-header flyout-panel-block-header">
                        
                    <h2 class="modal-title" id="Region-Modal">
                        <span class="icon fa-globe align-icons"></span>
                        Select Your Region
                        <div id="close_button" class="modal-footer flyout-panel-block-header">
                            <button type="button" class="close icon" aria-label="Close" data-igm-search-toggle="">
                                <span></span>
                            </button>
                        </div>
                    </h2>
                </div>
                <div class="modal-body lang-selector-body">
                    <div class="flyout-control-panel">
                        <ul class="list-unstyled flyout-control-listing" id="language-accordion">

                            {{#if alsoAvail}}
                            <div class="col-xs-12 lang-selector">
                                <h4 class="accordion-toggle fa- expanded" data-toggle="collapse"
                                    data-parent="#language-accordion"
                                    data-target="#header-translations">
                                    {{localeTitle}}</h4>
                            </div>
                            {{#each sections}}
                            <div id="header-translations" class="accordion-panel in">
                                {{#each locale}}
                                {{regionNames languageList @index countryName}}
                                {{/each}}
                            </div>
                            {{/each}}
                            {{/if}}

                            <div class="col-xs-12 lang-selector">
                                <h4 class="accordion-toggle fa- {{#if alsoAvail}}collapsed{{else}}expanded{{/if}}"
                                    data-toggle="collapse"
                                    data-parent="#language-accordion"
                                    data-target="#home-redirects">
                                    {{homepageTitle}}</h4>
                            </div>
                            {{#each sections}}
                            <div id="home-redirects"
                                 class="accordion-panel {{#if ../alsoAvail}}collapse{{else}}in{{/if}}">
                                {{#each locale}}
                                <li>
                                    <a href="#homepage-{{@index}}" data-toggle="flyout" class="flyout-control">{{{countryName}}}<span
                                            class="icon-caret fa-angle-right"></span></a>
                                </li>
                                {{/each}}
                            </div>
                            {{/each}}

                        </ul>
                        {{#each sections}}
                        {{#each locale}}
                        {{storeIndex @index}}

                        <div class="flyout-panel flyout-panel-position-right flyout-panel-closed force-background"
                             id="geo-{{getIndex}}">
                            <div class="flyout-panel-inner">
                                <div class="flyout-panel-header">
                                    <a href="#" class="close-flyout back-link pull-left"><span
                                            class="icon-back fa-angle-left"></span>
                                        back</a>
                                </div>
                                <div class="flyout-panel-body">
                                    <div class="igm-text-listing">
                                        <div class="pad-btm-10">
                                            <ul class="list-unstyled">
                                                {{#each languageList}}
                                                {{#if localelink}}
                                                <li class="lang-option"><a
                                                        data-locale="{{{language}}}_{{{locale}}}"
                                                        href={{{localelink}}}>{{countryLanguageLabel label language}}</a>
                                                </li>
                                                {{/if}}
                                                {{/each}}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {{/each}}
                        {{/each}}

                        {{#each sections}}
                        {{#each locale}}
                        {{#if languageList}}
                        <div class="flyout-panel flyout-panel-position-right flyout-panel-closed force-background"
                             id="homepage-{{@index}}">
                            <div class="flyout-panel-inner">
                                <div class="flyout-panel-header">
                                    <a href="#" class="close-flyout back-link pull-left"><span
                                            class="icon-back fa-angle-left"></span>back</a>
                                </div>
                                <div class="flyout-panel-body">
                                    <div class="igm-text-listing">
                                        <div class="pad-btm-10">
                                            <ul class="list-unstyled">
                                                {{#each languageList}}
                                                {{#if_ne language 'en'
                                                locale 'us' }}
                                                <li class="lang-option"><a
                                                        data-locale="{{{language}}}_{{{locale}}}"
                                                        href={{{homepagelink}}}>{{countryLanguageLabel label language}}</a>
                                                </li>
                                                {{/if_ne}}
                                                {{/each}}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {{/if}}
                        {{/each}}
                        {{/each}}

                    </div>
                </div>
            </div>
        </div>
    </script>

    <script type="text/javascript">
        var langSelectData = {"alsoAvail":true,"mobileHomepageTitle":"Find your Country's/Region's Homepage","mobileSelectTitle":"Select a Country/Region","mobileAvailableTitle":"Page Available In","sections":[{"locale":[{"countryName":"Asia Pacific","languageList":[{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.sg/content/www/xa/en/homepage.html","localelink":"","label":"Asia Pacific (English)","locale":"xa","language":"en"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.com.au/content/www/au/en/homepage.html","localelink":"","label":"Australia (English)","locale":"au","language":"en"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.cn/content/www/cn/zh/homepage.html","localelink":"https://web.archive.org/web/20200917044707/https://www.intel.cn/content/www/cn/zh/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","label":"China (简体中文)","locale":"cn","language":"zh"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.in/content/www/in/en/homepage.html","localelink":"","label":"India (English)","locale":"in","language":"en"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.co.id/content/www/id/id/homepage.html","localelink":"","label":"Indonesia (Bahasa Indonesia)","locale":"id","language":"id"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.co.jp/content/www/jp/ja/homepage.html","localelink":"","label":"Japan (日本語)","locale":"jp","language":"ja"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.co.kr/content/www/kr/ko/homepage.html","localelink":"","label":"Korea (한국어)","locale":"kr","language":"ko"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.com.tw/content/www/tw/zh/homepage.html","localelink":"","label":"Taiwan (繁體中文)","locale":"tw","language":"zh"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.thailand.intel.com/content/www/th/th/homepage.html","localelink":"","label":"Thailand (ไทย)","locale":"th","language":"th"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.vn/content/www/vn/vi/homepage.html","localelink":"","label":"Vietnam (Tiếng Việt)","locale":"vn","language":"vi"}]},{"countryName":"Europe","languageList":[{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.fr/content/www/fr/fr/homepage.html","localelink":"","label":"France (Français)","locale":"fr","language":"fr"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.de/content/www/de/de/homepage.html","localelink":"","label":"Germany (Deutsch)","locale":"de","language":"de"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.ie/content/www/ie/en/homepage.html","localelink":"","label":"Ireland (English)","locale":"ie","language":"en"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.it/content/www/it/it/homepage.html","localelink":"","label":"Italy (Italiano)","locale":"it","language":"it"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.pl/content/www/pl/pl/homepage.html","localelink":"","label":"Poland (Polski)","locale":"pl","language":"pl"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.ru/content/www/ru/ru/homepage.html","localelink":"https://web.archive.org/web/20200917044707/https://www.intel.ru/content/www/ru/ru/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","label":"Russia (Русский)","locale":"ru","language":"ru"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.es/content/www/es/es/homepage.html","localelink":"","label":"Spain (Español)","locale":"es","language":"es"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.com.tr/content/www/tr/tr/homepage.html","localelink":"","label":"Turkey (Türkçe)","locale":"tr","language":"tr"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.co.uk/content/www/uk/en/homepage.html","localelink":"","label":"United Kingdom (English)","locale":"uk","language":"en"}]},{"countryName":"Latin America","languageList":[{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/homepage.html","localelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","label":"Argentina (Español)","locale":"xl","language":"es"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.com.br/content/www/br/pt/homepage.html","localelink":"https://web.archive.org/web/20200917044707/https://www.intel.com.br/content/www/br/pt/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","label":"Brazil (Português)","locale":"br","language":"pt"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/homepage.html","localelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","label":"Chile (Español)","locale":"xl","language":"es"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/homepage.html","localelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","label":"Colombia (Español)","locale":"xl","language":"es"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/homepage.html","localelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","label":"Latin America (Español)","locale":"xl","language":"es"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/homepage.html","localelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","label":"Mexico (Español)","locale":"xl","language":"es"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/homepage.html","localelink":"https://web.archive.org/web/20200917044707/https://www.intel.la/content/www/xl/es/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html","label":"Peru (Español)","locale":"xl","language":"es"}]},{"countryName":"Middle East/Africa","languageList":[{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.co.il/content/www/il/he/homepage.html","localelink":"","label":"Israel (עברית)","locale":"il","language":"he"}]},{"countryName":"North America","languageList":[{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.com/content/www/us/en/homepage.html","localelink":"","label":"United States (English)","locale":"us","language":"en"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.ca/content/www/ca/en/homepage.html","localelink":"","label":"Canada (English)","locale":"ca","language":"en"},{"homepagelink":"https://web.archive.org/web/20200917044707/https://www.intel.ca/content/www/ca/fr/homepage.html","localelink":"","label":"Canada (Français)","locale":"ca","language":"fr"}]}]}],"homepageTitle":"Go to your Country's/Region's Homepage","localeTitle":"This page is also available in"};
    </script>


                </div>
                <div class="slide-signin">
                    





































    
    
        
        
        
    




<div class="modal-intel modal-signin" id="modal-signin-form" aria-labelledby="Signin">
    <div class="slide-signin-block" data-component="signincomponent" data-component-id="1">
        <div class="modal-header">
            <button type="button" class="close icon theme-white" data-igm-search-toggle="" aria-label="Close">
                <span></span></button>
            <h2 class="modal-title" id="Signin"><span class="icon-login align-icons fa-"></span>Sign In</h2>
        </div>

        <div class="modal-body">
            <div class="alert alert-danger" id="login-error" role="alert"></div>
            <form id="igm-form-signin" action="https://web.archive.org/web/20200917044707/https://www.intel.com/libs/apps/intel/login.json/securitytoken" method="POST" name="igm-form-signin" class="igm-form-signin intel-form" novalidate="">
                <div class="form-group">
                    <label for="username">
                        <input class="form-control form-input" aria-describedby="uname-error" name="userid" id="username" placeholder="Username" required="">
                    </label>
                    <div class="error validation-messages" id="uname-error">
                        <div class="rule broken">Your username is missing</div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="password">
                        <input type="password" class="form-control form-input" aria-describedby="pwd-error" id="password" name="password" placeholder="Password" required="" autocomplete="off">
                    </label>
                    <div class="error validation-messages" id="pwd-error">
                        <div class="rule broken">Your password is missing</div>
                    </div>
                </div>
                <p>By signing in, you agree to our <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/legal/terms-of-use.html">Terms of Service</a>.</p>
                <div class="row">
                    <div class="col-xs-12">
                        <input type="hidden" name="callBack" id="callBackSimplify">
                        <input type="hidden" name="queryParam" id="queryParam">
                        <input type="submit" class="btn btn-primary" value="Sign In" data-wap="{&quot;linktype&quot;:&quot;sign-in&quot;}">
                        <label for="cbRememberMe" class="remember-user"><input id="cbRememberMe" name="rememberme" type="checkbox" value="true">
                            <span>Remember me</span></label>
                    </div>
                </div>
            </form>
            <p>
                Forgot your Intel
                <a href="https://web.archive.org/web/20200917044707/https://www.intel.com/content/www/us/en/my-intel/forgot-userid.html">username</a>
                or
                <a href="https://web.archive.org/web/20200917044707/https://www.intel.com/content/www/us/en/my-intel/forgot-password.html">password</a>?
            </p>

            <p class="mobile-intel-signin">Do you work for Intel? <a href="#" onclick="intel.signinsimplify.geturl('https://web.archive.org/web/20200917044707/https://sifederation.intel.com/federation/bridge/sso_irp.asp?target=')">Sign in here</a>.</p>
            
                <p>
                    Don’t have an Intel account?
                    <a href="#" onclick="intel.signinHeaderSimplify.doRedirect('/forms/basic-intel-registration.html')">
                        Sign up here
                    </a>
                    for a basic account.
                </p>
            
        </div>
    </div>
</div>
<iframe id="frameSigninSimplify" tabindex="-1" title="My Intel Sign in" aria-hidden="true" name="frameSigninSimplify" src="/web/20200917044707if_/https://software.intel.com/etc.clientlibs/settings/wcm/designs/intel/clientlibs/pages/commons-page/resources/html/idamFormStaticSimplify.html" style="display:none;" data-ruffle-polyfilled=""></iframe>


<script>

    
    

    
    var intel = intel || {};
    intel.signinsimplifyConfig = {
        locale: '',
        messages: {
            InvalidCredential: 'The username or password you entered was invalid.',
            InvalidField: 'The username or password you entered was invalid.',
            AccountDisabled: 'For security reasons, your account has been disabled. For help, <a href=\"#\" class=\"contactLink new-tab-link\" target=\"_blank\" rel=\"noopener noreferrer\" >contact us<\/a>.',
            AccountLocked: 'Your account has been locked. For help, please read the <a href=\"#\" class=\"faqsLink new-tab-link\" target=\"_blank\" rel=\"noopener noreferrer\" >Sign In FAQ<\/a>.',
            UserNotFound: 'The username or password you entered was invalid.',
            Unknown: 'An unexpected error occurred. Try it again. For help, use the contact or support options below.',
            PasswordExpired: 'Your password is expired. Please change your password.',
            LoginAssistLink: 'https://web.archive.org/web/20200917044707/https://signin.intel.com/ContactUs.aspx',
            faqsLink: '/content/www/us/en/my-intel/sign-in-help.html'
        },
        nameField: 'Username',
        passField: 'Password',
        signinUrl: '/libs/apps/intel/login.json/securitytoken',
        isPopup: true,
        responseHref: 'https://web.archive.org/web/20200917044707/https://www.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-5.html' + window.location.hash,
        sslDomainUrl: 'www.intel.com',
        loginUrl: 'https://web.archive.org/web/20200917044707/https://welcome.intel.com/login.aspx?appid=258&qlogin=true',
        ssoUri: 'https://web.archive.org/web/20200917044707/https://federatesso.intel.com',
        logoutUrl: 'https://web.archive.org/web/20200917044707/https://welcome.intel.com/logout.aspx',
        logoutHref: 'https://web.archive.org/web/20200917044707/https://signin.intel.com/Logout?RedirectURL=https://www.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-5' + '.html',
        loginErrorID: '#login-error',
        usernameID: '#username',
        remembermeId: '#cbRememberMe',
        formID: '#igm-form-signin',
        unameErrorID: '#uname-error',
        passID: '#password',
        passError: '#pwd-error',
        changePasswordUrl: '/content/www/us/en/my-intel/change-password.html',
        emailVerificationUrl: '/content/www/us/en/my-intel/email-verification.expired.html',
        aboutToExpireEmailUrl: '/content/www/us/en/my-intel/email-verification.html',
        renewalUrl: '/content/www/us/en/secure/technology-provider/forms/renew-technology-provider-membership.html',
        limitedUrl: '/content/www/us/en/resellers/limited-status-secondary.html',
        isaPRMDashBoardURL: '/content/www/us/en/secure/partner/solutions-alliance/overview.html',
        itpPRMDashBoardURL: '/content/www/us/en/secure/partner/technology-provider/iot/overview.html',
        itpisaPRMDashBoardURL: '/content/www/us/en/secure/partner/iot-itp-isa/overview.html',
        isaRenewalURL: '/content/www/us/en/secure/partner/forms/solutions-alliance-renewal.html',
    };
    
    if(location.protocol=='https:' && document.cookie.indexOf('SMSESSION')!=-1) {
        if (document.cookie.indexOf('IGHFLoggedIn') == -1) {
            var currentUrl = window.location.href;
            var cookiename = "IGHFtarget";
            var samlcookieValue = cookiename + "=" + encodeURIComponent(currentUrl) + ";secure;path=/;domain=.intel.com";
            document.cookie= samlcookieValue;
            window.location.href = 'https://web.archive.org/web/20200917044707/https://sfederation.intel.com/federation2/sp/WebExperienceManagementSolutiononAEMforIntel/d3d3LmludGVsLmNvbQ%3D%3D';
        }
    }
    
</script>

                </div>
                    <div class="slide-myintel component" data-component="myintel-navmenu" data-component-id="1"></div>
            </div>
            <div class="search-info">

                
                
                
                    <a id="dropDownSearchSignIn" target="_self" tabindex="0" href="#" class="login-toggle pale-blue" data-target="#modal-signin-form">Sign In</a> to access restricted content.
            </div>
            <div class="signout-info">
                <button type="button" class="btn btn-primary" data-sso-uri="https://federatesso.intel.com" data-logout-uri="" data-wap="{&quot;linktype&quot;:&quot;logout&quot;}" onclick="intel.signinsimplify.signOut()">Sign Out
                </button>
            </div>
        </div>
    </div>

<script type="text/javascript">
    var global_config = {
        "icsUrl": "https://web.archive.org/web/20200917044707/https://supporttickets.intel.com/services/oauth2/authorize?response_type=token&client_id=3MVG9QDx8IX8nP5Rh0X3B7gohGtUh8sjFQ8Tw_U8sS9_PoVrupDFwZ_nwLcze2n64lGBbGchyUb7_9W8n8pAV&redirect_uri=https%3A%2F%2Fsoftware.intel.com%2Fcontent%2Fwww%2Fus%2Fen%2Fsecure%2Fmy-intel%2Ftoken.html",
        "ipsUrl": "https://web.archive.org/web/20200917044707/https://premiersupport.intel.com/IPS/services/oauth2/authorize?response_type=token&client_id=3MVG9xOCXq4ID1uEa5F2lCYAp6mmKvTMlKbMIrsMKShY2oOqs1ETvPRjwmhoPivHd9_U53EzmiyYxn3nVpA9J&redirect_uri=https%3A%2F%2Fsoftware.intel.com%2Fcontent%2Fwww%2Fus%2Fen%2Fsecure%2Fmy-intel%2Ftoken.html"
    };
    var globalSearch = globalSearch || {};
    globalSearch = {
        sharePointSearchPromote:true,
        searchProvider: 'coveo',
        baseSearchQuery: 'localecode:"en_US" NOT generic1:"false" ',
        langRootPath: '/content/www/us/en',
        headingTxt: 'Best Match',
        locale: 'en_US',
        typeAheadUrl: 'https://web.archive.org/web/20200917044707/http://search.intel.com/SearchLookup/DataProvider.ashx',
        bestMatchUrl: 'https://web.archive.org/web/20200917044707/https://platform.cloud.coveo.com/rest/search/v2/querySuggest',
        searchRealm: 'Default',
        bestMatchQ1: 'NAR',
        bestMatchQ2: 'en',
        bestMatchQ11: 'sptitle,description,url,thumbnailurl,reimaginerootlevel',
        progId: '',
        useEMTTags: true,
        defaultPage: 'search.html',
        token: 'xx43151f87-f1d8-4211-ae65-ce98d805849c',
        searchHub: 'entepriseSearch',

        gtvLabels: {
            suggested: "",
            products: "Products",
            support: "Support",
            developers: "Developers",
            drivers: "Drivers",
            forums: "Forums",
            specifications: "Specifications",
            download: "",
            searchesRelatedTo: "",
            search: "Search Intel.com",
            inLabel: "in",
            searchSupport: "Search Intel® Support",
            intelcom: "",
            forLabel: "for",
            allResults: "All Results",
            show: "Show",
            results: "Results"
        },
        mobileResults: "5",
        laptopResults: "10",
        EDCProgramIdentifier: "false",
        rdcContentDataSource: ""
    };
</script>
</div>

                </nav>
                <!-- end global intel header -->
                <div class="mega-menu-content"></div>
                    
            </header>
        </div>

        <script type="text/javascript">
            var globalHeader = globalHeader || {};
            globalHeader = {
                currentPath: "/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-5",
                lanloc: "/us/en",
                lanLoc: "US/en",
                helpformurl: "",
                intelHeaderFooterVersion: "menu3",
                megaMenuPath: "/content/data/globalelements/US/en/globalnav4",
                globalBannerPath: "/content/data/globalelements/US/en/sitewide-banner-placeholder",
                subMenuPath: "/content/data/globalelements/US/en/sub-navigation/idz/idz-gd",
                isCHF:false,
                secureRedirectURL: "",
            }
        </script>
    


        
    


<section data-scroll-track="false">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 pull-right persistent-cta-integration-globalNav" id="alertMsg">
                <div id="alertSupport">
                    <div class="browser_detect" id="browserdetectid" style="display:none;">
                        <p>The browser version you are using is not recommended for this site.<br>Please consider upgrading to the latest version of your browser by clicking one of the following links.</p>
                        <div class="browser_types">
                            <ul>
                                
                                    <li><a href="https://web.archive.org/web/20200917044707/https://support.apple.com/downloads/safari">Safari</a></li>
                                
                                    <li><a href="https://web.archive.org/web/20200917044707/https://support.google.com/chrome/answer/95346?hl=en">Chrome</a></li>
                                
                                    <li><a href="https://web.archive.org/web/20200917044707/https://www.microsoft.com/en-us/edge">Edge</a></li>
                                
                                    <li><a href="https://web.archive.org/web/20200917044707/https://www.mozilla.org/en-US/firefox/new/">Firefox</a></li>
                                
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>



















<div class="editorialpost editorialPost parbase">

















<link rel="stylesheet" href="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/idzLibs.min.css" type="text/css"><script src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/idzLibs.min.js" defer="defer"></script>





<header class="editorialPostHeader">
    <div class="sticky_button_blue sticky_button_blue_pp">
        <div class="persistent_cta_bar">
















</div>

    </div>
    
    <h1 class="editorialTitle"> API without Secrets: Introduction to Vulkan* Part 5 </h1>
    <p class="editAuthor">
        <span class="label-style">By</span>

            
                
                    <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/en-us/profile/+rw9Uv7oFRNFxXzJ/NuMzw==">Pawel Lapinski</a><span class="label-style">,</span>
                
                
            

            
        
    </p>
    <div class="editorialDisplayLine">
        <p class="editorialDisplayLineHide">

            
            
            

                        <span class="label-style">  Published:</span>08/12/2016&nbsp;&nbsp;
                <span class="label-style"> Last Updated:</span>08/12/2016

            
            
            
            
            

        </p>
    </div>
</header>
<div class="editorialPostNav ">
    
        <div id="inpage-navigation" class="inpage-navigation" style="height: 100%;"><h4 id="inpage-nav-contents">CONTENTS</h4><ul class="inpage-nav"><li class="parent nochildren"><a class="jumplink" href="#inpage-nav-undefined"><span class="word_arrow">Tutorial</span> 5: Staging Resources – Copying Data between Buffers</a></li><li class="parent nochildren"><a class="jumplink" href="#inpage-nav-1"><span class="word_arrow">Creating</span> Rendering Resources</a></li><li class="parent haschildren"><a class="jumplink" href="#inpage-nav-2"><span class="word_arrow">Buffer</span> creation</a><ul class="inpage-nav list-h3" style=""><li class="parent nochildren"><a class="jumplink" href="#inpage-nav-2-undefined"><span class="word_arrow">Vertex</span> Buffer Creation</a></li><li class="parent nochildren"><a class="jumplink" href="#inpage-nav-2-1"><span class="word_arrow">Staging</span> Buffer Creation</a></li></ul></li><li class="parent haschildren"><a class="jumplink" href="#inpage-nav-3"><span class="word_arrow">Copying</span> Data between Buffers</a><ul class="inpage-nav list-h3" style=""><li class="parent nochildren"><a class="jumplink" href="#inpage-nav-3-undefined"><span class="word_arrow">Setting</span> a Buffer Memory Barrier</a></li></ul></li><li class="parent nochildren"><a class="jumplink" href="#inpage-nav-4"><span class="word_arrow">Tutorial05</span> Execution</a></li><li class="parent nochildren"><a class="jumplink" href="#inpage-nav-5"><span class="word_arrow">Cleaning</span> Up</a></li><li class="parent nochildren"><a class="jumplink" href="#inpage-nav-6"><span class="word_arrow">Conclusion</span></a></li></ul></div>
    
</div>
<div class="editorialPostContent ">
    <div class="editorialBody">
        <p></p><p><a class="button-highlight" href="https://web.archive.org/web/20200917044707/https://github.com/GameTechDev/IntroductionToVulkan" target="_blank" rel="nofollow">Download</a></p>

<p><a class="button-white-border" href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/dam/develop/external/us/en/documents/vulkan-tutorial-05-copying-data-between-buffers-673812.pdf">View PDF</a> [723KB]</p>

<p><strong>Back to: <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-4.html">Part 4 Vertex Attributes</a><br>
	Next up: <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-6.html">Part 6 Descriptor Sets</a></strong></p>

<hr>
<h2>Tutorial 5: Staging Resources – Copying Data between Buffers<a class="inpage-nav-anchor" id="inpage-nav-undefined"></a></h2>

<p>In this part of the tutorial we will focus on improving performance. 
At the same time, we will prepare for the next tutorial, in which we 
introduce images and descriptors (shader resources). Using the knowledge
 we gather here, it will be easier for us to follow the next part and 
squeeze as much performance as possible from our graphics hardware.</p>

<p>What are “staging resources” or “staging buffers”? They are 
intermediate or temporary resources used to transfer data from an 
application (CPU) to a graphics card’s memory (GPU). We need them to 
increase our application’s performance.</p>

<p>In Part 4 of the tutorial we learned how to use buffers, bind them to
 a host‑visible memory, map this memory, and transfer data from the CPU 
to the GPU. This approach is easy and convenient for us, but we need to 
know that host‑visible parts of a graphics card’s memory aren’t the most
 efficient. Typically, they are much slower than the parts of the memory
 that are not directly accessible to the application (cannot be mapped 
by an application). This causes our application to execute in a 
sub-optimal way.</p>

<p>One solution to this problem is to always use device-local memory for
 all resources involved in a rendering process. But as device-local 
memory isn’t accessible for an application, we cannot directly transfer 
any data from the CPU to such memory. That’s why we need intermediate, 
or staging, resources.</p>

<p>In this part of the tutorial we will bind the buffer with vertex 
attribute data to the device-local memory. And we will use the staging 
buffer to mediate the transfer of data from the CPU to the vertex 
buffer.</p>

<p>Again, only the differences between this tutorial and the previous tutorial (Part 4) are described.</p>

<h2>Creating Rendering Resources<a class="inpage-nav-anchor" id="inpage-nav-1"></a></h2>

<p>This time I have moved rendering resources creation to the beginning 
of our code. Later we will need to record and submit a command buffer to
 transfer data from the staging resource to the vertex buffer. I have 
also refactored rendering resource creation code to eliminate multiple 
loops and replace them with only one loop. In this loop we can create 
all resources that compose our <em>virtual frame</em>.</p>
<div class="code-toolbar"><pre class=" language-cpp line-numbers"><div class="toolbar" style="float: right;"><div class="toolbar-item"><a>Copy Code</a></div></div><code class=" language-cpp"><span class="token keyword keyword-bool">bool</span> Tutorial05<span class="token operator">::</span><span class="token function">CreateRenderingResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">CreateCommandPool</span><span class="token punctuation">(</span> <span class="token function">GetGraphicsQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>FamilyIndex<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Vulkan<span class="token punctuation">.</span>CommandPool <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword keyword-for">for</span><span class="token punctuation">(</span> size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">AllocateCommandBuffers</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>CommandPool<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CommandBuffer <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">CreateSemaphore</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ImageAvailableSemaphore <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">CreateSemaphore</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>FinishedRenderingSemaphore <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">CreateFence</span><span class="token punctuation">(</span> VK_FENCE_CREATE_SIGNALED_BIT<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Fence <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-bool">bool</span> Tutorial05<span class="token operator">::</span><span class="token function">CreateCommandPool</span><span class="token punctuation">(</span> <span class="token keyword keyword-uint32_t">uint32_t</span> queue_family_index<span class="token punctuation">,</span> VkCommandPool <span class="token operator">*</span>pool <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  VkCommandPoolCreateInfo cmd_pool_create_info <span class="token operator">=</span> <span class="token punctuation">{</span>
    VK_STRUCTURE_TYPE_COMMAND_POOL_CREATE_INFO<span class="token punctuation">,</span>       <span class="token comment">// VkStructureType                sType</span>
    <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const void                    *pNext</span>
    VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT <span class="token operator">|</span> <span class="token comment">// VkCommandPoolCreateFlags       flags</span>
    VK_COMMAND_POOL_CREATE_TRANSIENT_BIT<span class="token punctuation">,</span>
    queue_family_index                                <span class="token comment">// uint32_t                       queueFamilyIndex</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token function">vkCreateCommandPool</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>cmd_pool_create_info<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span> pool <span class="token punctuation">)</span> <span class="token operator">!=</span> VK_SUCCESS <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not create command pool!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-bool">bool</span> Tutorial05<span class="token operator">::</span><span class="token function">AllocateCommandBuffers</span><span class="token punctuation">(</span> VkCommandPool pool<span class="token punctuation">,</span> <span class="token keyword keyword-uint32_t">uint32_t</span> count<span class="token punctuation">,</span> VkCommandBuffer <span class="token operator">*</span>command_buffers <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  VkCommandBufferAllocateInfo command_buffer_allocate_info <span class="token operator">=</span> <span class="token punctuation">{</span>
    VK_STRUCTURE_TYPE_COMMAND_BUFFER_ALLOCATE_INFO<span class="token punctuation">,</span>   <span class="token comment">// VkStructureType                sType</span>
    <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const void                    *pNext</span>
    pool<span class="token punctuation">,</span>                                             <span class="token comment">// VkCommandPool                  commandPool</span>
    VK_COMMAND_BUFFER_LEVEL_PRIMARY<span class="token punctuation">,</span>                  <span class="token comment">// VkCommandBufferLevel           level</span>
    count                                             <span class="token comment">// uint32_t                       bufferCount</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token function">vkAllocateCommandBuffers</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>command_buffer_allocate_info<span class="token punctuation">,</span> command_buffers <span class="token punctuation">)</span> <span class="token operator">!=</span> VK_SUCCESS <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not allocate command buffer!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-bool">bool</span> Tutorial05<span class="token operator">::</span><span class="token function">CreateSemaphore</span><span class="token punctuation">(</span> VkSemaphore <span class="token operator">*</span>semaphore <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  VkSemaphoreCreateInfo semaphore_create_info <span class="token operator">=</span> <span class="token punctuation">{</span>
    VK_STRUCTURE_TYPE_SEMAPHORE_CREATE_INFO<span class="token punctuation">,</span>          <span class="token comment">// VkStructureType                sType</span>
    <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const void*                    pNext</span>
    <span class="token number">0</span>                                                 <span class="token comment">// VkSemaphoreCreateFlags         flags</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token function">vkCreateSemaphore</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>semaphore_create_info<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span> semaphore <span class="token punctuation">)</span> <span class="token operator">!=</span> VK_SUCCESS <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not create semaphore!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-bool">bool</span> Tutorial05<span class="token operator">::</span><span class="token function">CreateFence</span><span class="token punctuation">(</span> VkFenceCreateFlags flags<span class="token punctuation">,</span> VkFence <span class="token operator">*</span>fence <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  VkFenceCreateInfo fence_create_info <span class="token operator">=</span> <span class="token punctuation">{</span>
    VK_STRUCTURE_TYPE_FENCE_CREATE_INFO<span class="token punctuation">,</span>              <span class="token comment">// VkStructureType                sType</span>
    <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const void                    *pNext</span>
    flags                                             <span class="token comment">// VkFenceCreateFlags             flags</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token function">vkCreateFence</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>fence_create_info<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span> fence <span class="token punctuation">)</span> <span class="token operator">!=</span> VK_SUCCESS <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not create a fence!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token number">1.</span>	Tutorial05<span class="token punctuation">.</span>cpp
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre></div>

<p><strong>1.</strong> <em>Tutorial05.cpp</em></p>

<p>First we create a command pool for which we indicate that command 
buffers allocated from this pool will be short lived. In our case, all 
command buffers will be submitted only once before rerecording.</p>

<p>Next we iterate over the arbitrary chosen number of <em>virtual frames</em>. In this code example, the number of <em>virtual frames</em> is three. Inside the loop, for each <em>virtual frame</em>,
 we allocate one command buffer, create two semaphores (one for image 
acquisition and a second to indicate that frame rendering is done) and a
 fence. Framebuffer creation is done inside a drawing function, just 
before command buffer recording.</p>

<p>This is the same set of rendering resources used in Part 4, where you
 can find a more thorough explanation of what is going on in the code. I
 will also skip render pass and graphics pipeline creation. They are 
created in exactly the same way they were created previously. Since 
nothing has changed here, we will jump directly to buffer creation.</p>

<h2>Buffer creation<a class="inpage-nav-anchor" id="inpage-nav-2"></a></h2>

<p>Here is our general code used for buffer creation:</p>
<div class="code-toolbar"><pre class=" language-cpp line-numbers"><div class="toolbar" style="float: right;"><div class="toolbar-item"><a>Copy Code</a></div></div><code class=" language-cpp">VkBufferCreateInfo buffer_create_info<span class="token operator">=</span> <span class="token punctuation">{</span>
  VK_STRUCTURE_TYPE_BUFFER_CREATE_INFO<span class="token punctuation">,</span>             <span class="token comment">// VkStructureType                sType</span>
  <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const void                    *pNext</span>
  <span class="token number">0</span><span class="token punctuation">,</span>                                                <span class="token comment">// VkBufferCreateFlags            flags</span>
  buffer<span class="token punctuation">.</span>Size<span class="token punctuation">,</span>                                      <span class="token comment">// VkDeviceSize                   size</span>
  usage<span class="token punctuation">,</span>                                            <span class="token comment">// VkBufferUsageFlags             usage</span>
  VK_SHARING_MODE_EXCLUSIVE<span class="token punctuation">,</span>                        <span class="token comment">// VkSharingMode                  sharingMode</span>
  <span class="token number">0</span><span class="token punctuation">,</span>                                                <span class="token comment">// uint32_t                       queueFamilyIndexCount</span>
  <span class="token keyword keyword-nullptr">nullptr</span>                                           <span class="token comment">// const uint32_t                *pQueueFamilyIndices</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token function">vkCreateBuffer</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buffer_create_info<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buffer<span class="token punctuation">.</span>Handle <span class="token punctuation">)</span> <span class="token operator">!=</span> VK_SUCCESS <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not create buffer!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">AllocateBufferMemory</span><span class="token punctuation">(</span> buffer<span class="token punctuation">.</span>Handle<span class="token punctuation">,</span> memoryProperty<span class="token punctuation">,</span> <span class="token operator">&amp;</span>buffer<span class="token punctuation">.</span><span class="token type-opencl-host-c++ keyword">Memory</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not allocate memory for a buffer!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token function">vkBindBufferMemory</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> buffer<span class="token punctuation">.</span>Handle<span class="token punctuation">,</span> buffer<span class="token punctuation">.</span><span class="token type-opencl-host-c++ keyword">Memory</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token operator">!=</span> VK_SUCCESS <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not bind memory to a buffer!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre></div>

<p><strong>2.</strong> <em>Tutorial05.cpp, function CreateBuffer()</em></p>

<p>The code is wrapped into a CreateBuffer() function, which accepts the
 buffer’s usage, size, and requested memory properties. To create a 
buffer we need to prepare a variable of type VkBufferCreateInfo. It is a
 structure that contains the following members:</p>

<ul>
	<li>sType – Standard type of the structure. Here it should be equal to VK_STRUCTURE_TYPE_BUFFER_CREATE_INFO.</li>
	<li>pNext – Pointer reserved for extensions.</li>
	<li>flags – Parameter describing additional properties of the buffer. 
Right now we can only specify that the buffer can be backed by a sparse 
memory.</li>
	<li>size – Size of the buffer (in bytes).</li>
	<li>usage – Bitfield indicating intended usages of the buffer.</li>
	<li>sharingMode – Queue sharing mode.</li>
	<li>queueFamilyIndexCount – Number of different queue families that will access the buffer in case of a concurrent sharing mode.</li>
	<li>pQueueFamilyIndices – Array with indices of all queue families that will access the buffer when concurrent sharing mode is used.</li>
</ul>

<p>Right now we are not interested in binding a sparse memory. We do not
 want to share the buffer between different device queues, so 
sharingMode, queueFamilyIndexCount, and pQueueFamilyIndices parameters 
are irrelevant. The most important parameters are size and usage. We are
 not allowed to use a buffer in a way that is not specified during 
buffer creation. Finally, we need to create a buffer that is large 
enough to contain our data.</p>

<p>To create a buffer we call the <strong>vkCreateBuffer()</strong> 
function, which when successful stores the buffer handle in a variable 
we provided the address of. But creating a buffer is not enough. A 
buffer, after creation, doesn’t have any storage. We need to bind a 
memory object (or part of it) to the buffer to back its storage. Or, if 
we don’t have any memory objects, we need to allocate one.</p>

<p>Each buffer’s usage may have a different memory requirement, which is
 relevant when we want to allocate a memory object and bind it to the 
buffer. Here is a code sample that allocates a memory object for a given
 buffer:</p>
<div class="code-toolbar"><pre class=" language-cpp line-numbers"><div class="toolbar" style="float: right;"><div class="toolbar-item"><a>Copy Code</a></div></div><code class=" language-cpp">VkMemoryRequirements buffer_memory_requirements<span class="token punctuation">;</span>
<span class="token function">vkGetBufferMemoryRequirements</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>buffer_memory_requirements <span class="token punctuation">)</span><span class="token punctuation">;</span>

VkPhysicalDeviceMemoryProperties memory_properties<span class="token punctuation">;</span>
<span class="token function">vkGetPhysicalDeviceMemoryProperties</span><span class="token punctuation">(</span> <span class="token function">GetPhysicalDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>memory_properties <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-for">for</span><span class="token punctuation">(</span> <span class="token keyword keyword-uint32_t">uint32_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> memory_properties<span class="token punctuation">.</span>memoryTypeCount<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>buffer_memory_requirements<span class="token punctuation">.</span>memoryTypeBits <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
      <span class="token punctuation">(</span><span class="token punctuation">(</span>memory_properties<span class="token punctuation">.</span>memoryTypes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>propertyFlags <span class="token operator">&amp;</span> property<span class="token punctuation">)</span> <span class="token operator">==</span> property<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

    VkMemoryAllocateInfo memory_allocate_info <span class="token operator">=</span> <span class="token punctuation">{</span>
      VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO<span class="token punctuation">,</span>       <span class="token comment">// VkStructureType                sType</span>
      <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                      <span class="token comment">// const void                    *pNext</span>
      buffer_memory_requirements<span class="token punctuation">.</span>size<span class="token punctuation">,</span>              <span class="token comment">// VkDeviceSize                   allocationSize</span>
      i                                             <span class="token comment">// uint32_t                       memoryTypeIndex</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token function">vkAllocateMemory</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>memory_allocate_info<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span> memory <span class="token punctuation">)</span> <span class="token operator">==</span> VK_SUCCESS <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre></div>

<p><strong>3.</strong> <em>Tutorial05.cpp, function AllocateBufferMemory()</em></p>

<p>Similarly to the code in Part 4, we first check what the memory 
requirements for a given buffer are. After that we check the properties 
of a memory available in a given physical device. It contains 
information about the number of memory heaps and their capabilities.</p>

<p>Next we iterate over each available memory type and check if it is 
compatible with the requirement queried for a given buffer. We also 
check if a given memory type supports our additional, requested 
properties, for example, whether a given memory type is host-visible. 
When we find a match, we fill in a VkMemoryAllocateInfo structure and 
call a <strong>vkAllocateMemory()</strong> function.</p>

<p>The allocated memory object is then bound to our buffer, and from now on we can safely use this buffer in our application.</p>

<h3>Vertex Buffer Creation<a class="inpage-nav-anchor" id="inpage-nav-2-undefined"></a></h3>

<p>The first buffer we want to create is a vertex buffer. It stores data
 for vertex attributes that are used during rendering. In this example 
we store position and color for four vertices of a quad. The most 
important change from the previous tutorial is the use of a device-local
 memory instead of a host-visible memory. Device-local memory is much 
faster, but we can’t copy any data directly from the application to 
device-local memory. We need to use a staging buffer, from which we copy
 data to the vertex buffer.</p>

<p>We also need to specify two different usages for this buffer. The 
first is a vertex buffer usage, which means that we want to use the 
given buffer as a vertex buffer from which data for the vertex 
attributes will be fetched. The second is transfer dst usage, which 
means that we will copy data to this buffer. It will be used as a 
destination of any transfer (copy) operation.</p>

<p>The code that creates a buffer with all these requirements looks like this:</p>
<div class="code-toolbar"><pre class=" language-cpp line-numbers"><div class="toolbar" style="float: right;"><div class="toolbar-item"><a>Copy Code</a></div></div><code class=" language-cpp"><span class="token keyword keyword-const">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword keyword-float">float</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> vertex_data <span class="token operator">=</span> <span class="token function">GetVertexData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Vulkan<span class="token punctuation">.</span>VertexBuffer<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword keyword-static_cast">static_cast</span><span class="token operator">&lt;</span><span class="token keyword keyword-uint32_t">uint32_t</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>vertex_data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>vertex_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">CreateBuffer</span><span class="token punctuation">(</span> VK_BUFFER_USAGE_VERTEX_BUFFER_BIT <span class="token operator">|</span> VK_BUFFER_USAGE_TRANSFER_DST_BIT<span class="token punctuation">,</span> VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT<span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>VertexBuffer <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not create vertex buffer!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 45px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre></div>

<p><strong>4.</strong> <em>Tutorial05.cpp, function CreateVertexBuffer()</em></p>

<p>At the beginning we get the vertex data (hard-coded in a 
GetVertexData() function) to check how much space we need to hold values
 for all our vertices. After that we call a CreateBuffer() function 
presented earlier to create a vertex buffer and bind a device-local 
memory to it.</p>

<h3>Staging Buffer Creation<a class="inpage-nav-anchor" id="inpage-nav-2-1"></a></h3>

<p>Next we can create an intermediate staging buffer. This buffer is not
 used during the rendering process so it can be bound to a slower, 
host-visible memory. This way we can map it and copy data directly from 
the application. After that we can copy data from the staging buffer to 
any other buffer (or even image) that is bound to device-local memory. 
This way all resources that are used for rendering purposes are bound to
 the fastest available memory. We just need additional operations for 
the data transfer.</p>

<p>Here is a code that creates a staging buffer:</p>
<div class="code-toolbar"><pre class=" language-cpp line-numbers"><div class="toolbar" style="float: right;"><div class="toolbar-item"><a>Copy Code</a></div></div><code class=" language-cpp">Vulkan<span class="token punctuation">.</span>StagingBuffer<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token number">4000</span><span class="token punctuation">;</span>
<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">CreateBuffer</span><span class="token punctuation">(</span> VK_BUFFER_USAGE_TRANSFER_SRC_BIT<span class="token punctuation">,</span> VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT<span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>StagingBuffer <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not staging buffer!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre></div>

<p><strong>5.</strong> <em>Tutorial04.cpp, function CreateStagingBuffer()</em></p>

<p>We will copy data from this buffer to other resources, so we must 
specify a transfer src usage for it (it will be used as a source for 
transfer operations). We would also like to map it to be able to 
directly copy any data from the application. For this we need to use a 
host-visible memory and that’s why we specify this memory property. The 
buffer’s size is chosen arbitrarily, but should be large enough to be 
able to hold vertex data. In real-life scenarios we should try to reuse 
the staging buffer as many times as possible, in many cases, so its size
 should be big enough to cover most of data transfer operations in our 
application. Of course, if we want to do many transfer operations at the
 same time, we have to create multiple staging buffers.</p>

<h2>Copying Data between Buffers<a class="inpage-nav-anchor" id="inpage-nav-3"></a></h2>

<p>We have created two buffers: one for the vertex attributes data and 
the other to act as an intermediate buffer. Now we need to copy data 
from the CPU to the GPU. To do this we need to map the staging buffer 
and acquire a pointer that we can use to upload data to the graphics 
hardware’s memory. After that we need to record and submit a command 
buffer that will copy the vertex data from the staging buffer to the 
vertex buffer. And as all of our command buffers used for <em>virtual frames</em> and rendering are marked as short lived, we can safely use one of them for this operation.</p>

<p>First let’s see what our data for vertex attributes looks like:</p>
<div class="code-toolbar"><pre class=" language-cpp line-numbers"><div class="toolbar" style="float: right;"><div class="toolbar-item"><a>Copy Code</a></div></div><code class=" language-cpp"><span class="token keyword keyword-static">static</span> <span class="token keyword keyword-const">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword keyword-float">float</span><span class="token operator">&gt;</span> vertex_data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">-</span><span class="token number">0.7f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
  <span class="token comment">//</span>
  <span class="token operator">-</span><span class="token number">0.7f</span><span class="token punctuation">,</span> <span class="token number">0.7f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
  <span class="token comment">//</span>
  <span class="token number">0.7f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
  <span class="token comment">//</span>
  <span class="token number">0.7f</span><span class="token punctuation">,</span> <span class="token number">0.7f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
  <span class="token number">0.3f</span><span class="token punctuation">,</span> <span class="token number">0.3f</span><span class="token punctuation">,</span> <span class="token number">0.3f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-return">return</span> vertex_data<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre></div>

<p><strong>6.</strong> <em>Tutorial05.cpp, function GetVertexData()</em></p>

<p>It is a simple, hard-coded array of floating point values. Data for 
each vertex contains four components for position attribute and four 
components for color attribute. As we render a quad, we have four pairs 
of such attributes.</p>

<p>Here is the code that copies data from the application to the staging
 buffer and after that from the staging buffer to the vertex buffer:</p>
<div class="code-toolbar"><pre class=" language-cpp line-numbers"><div class="toolbar" style="float: right;"><div class="toolbar-item"><a>Copy Code</a></div></div><code class=" language-cpp"><span class="token comment">// Prepare data in a staging buffer</span>
<span class="token keyword keyword-const">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword keyword-float">float</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> vertex_data <span class="token operator">=</span> <span class="token function">GetVertexData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-void">void</span> <span class="token operator">*</span>staging_buffer_memory_pointer<span class="token punctuation">;</span>
<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token function">vkMapMemory</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>StagingBuffer<span class="token punctuation">.</span><span class="token type-opencl-host-c++ keyword">Memory</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>VertexBuffer<span class="token punctuation">.</span>Size<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>staging_buffer_memory_pointer<span class="token punctuation">)</span> <span class="token operator">!=</span> VK_SUCCESS <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not map memory and upload data to a staging buffer!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">memcpy</span><span class="token punctuation">(</span> staging_buffer_memory_pointer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>vertex_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>VertexBuffer<span class="token punctuation">.</span>Size <span class="token punctuation">)</span><span class="token punctuation">;</span>

VkMappedMemoryRange flush_range <span class="token operator">=</span> <span class="token punctuation">{</span>
  VK_STRUCTURE_TYPE_MAPPED_MEMORY_RANGE<span class="token punctuation">,</span>            <span class="token comment">// VkStructureType                        sType</span>
  <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const void                            *pNext</span>
  Vulkan<span class="token punctuation">.</span>StagingBuffer<span class="token punctuation">.</span><span class="token type-opencl-host-c++ keyword">Memory</span><span class="token punctuation">,</span>                      <span class="token comment">// VkDeviceMemory                         memory</span>
  <span class="token number">0</span><span class="token punctuation">,</span>                                                <span class="token comment">// VkDeviceSize                           offset</span>
  Vulkan<span class="token punctuation">.</span>VertexBuffer<span class="token punctuation">.</span>Size                          <span class="token comment">// VkDeviceSize                           size</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">vkFlushMappedMemoryRanges</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>flush_range <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">vkUnmapMemory</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>StagingBuffer<span class="token punctuation">.</span><span class="token type-opencl-host-c++ keyword">Memory</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Prepare command buffer to copy data from staging buffer to a vertex buffer</span>
VkCommandBufferBeginInfo command_buffer_begin_info <span class="token operator">=</span> <span class="token punctuation">{</span>
  VK_STRUCTURE_TYPE_COMMAND_BUFFER_BEGIN_INFO<span class="token punctuation">,</span>      <span class="token comment">// VkStructureType                        sType</span>
  <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const void                            *pNext</span>
  VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT<span class="token punctuation">,</span>      <span class="token comment">// VkCommandBufferUsageFlags              flags</span>
  <span class="token keyword keyword-nullptr">nullptr</span>                                           <span class="token comment">// const VkCommandBufferInheritanceInfo  *pInheritanceInfo</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

VkCommandBuffer command_buffer <span class="token operator">=</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CommandBuffer<span class="token punctuation">;</span>

<span class="token function">vkBeginCommandBuffer</span><span class="token punctuation">(</span> command_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>command_buffer_begin_info<span class="token punctuation">)</span><span class="token punctuation">;</span>

VkBufferCopy buffer_copy_info <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">0</span><span class="token punctuation">,</span>                                                <span class="token comment">// VkDeviceSize                           srcOffset</span>
  <span class="token number">0</span><span class="token punctuation">,</span>                                                <span class="token comment">// VkDeviceSize                           dstOffset</span>
  Vulkan<span class="token punctuation">.</span>VertexBuffer<span class="token punctuation">.</span>Size                          <span class="token comment">// VkDeviceSize                           size</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">vkCmdCopyBuffer</span><span class="token punctuation">(</span> command_buffer<span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>StagingBuffer<span class="token punctuation">.</span>Handle<span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>VertexBuffer<span class="token punctuation">.</span>Handle<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buffer_copy_info <span class="token punctuation">)</span><span class="token punctuation">;</span>

VkBufferMemoryBarrier buffer_memory_barrier <span class="token operator">=</span> <span class="token punctuation">{</span>
  VK_STRUCTURE_TYPE_BUFFER_MEMORY_BARRIER<span class="token punctuation">,</span>          <span class="token comment">// VkStructureType                        sType;</span>
  <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const void                            *pNext</span>
  VK_ACCESS_MEMORY_WRITE_BIT<span class="token punctuation">,</span>                       <span class="token comment">// VkAccessFlags                          srcAccessMask</span>
  VK_ACCESS_VERTEX_ATTRIBUTE_READ_BIT<span class="token punctuation">,</span>              <span class="token comment">// VkAccessFlags                          dstAccessMask</span>
  VK_QUEUE_FAMILY_IGNORED<span class="token punctuation">,</span>                          <span class="token comment">// uint32_t                               srcQueueFamilyIndex</span>
  VK_QUEUE_FAMILY_IGNORED<span class="token punctuation">,</span>                          <span class="token comment">// uint32_t                               dstQueueFamilyIndex</span>
  Vulkan<span class="token punctuation">.</span>VertexBuffer<span class="token punctuation">.</span>Handle<span class="token punctuation">,</span>                       <span class="token comment">// VkBuffer                               buffer</span>
  <span class="token number">0</span><span class="token punctuation">,</span>                                                <span class="token comment">// VkDeviceSize                           offset</span>
  VK_WHOLE_SIZE                                     <span class="token comment">// VkDeviceSize                           size</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">vkCmdPipelineBarrier</span><span class="token punctuation">(</span> command_buffer<span class="token punctuation">,</span> VK_PIPELINE_STAGE_TRANSFER_BIT<span class="token punctuation">,</span> VK_PIPELINE_STAGE_VERTEX_INPUT_BIT<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buffer_memory_barrier<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">vkEndCommandBuffer</span><span class="token punctuation">(</span> command_buffer <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Submit command buffer and copy data from staging buffer to a vertex buffer</span>
VkSubmitInfo submit_info <span class="token operator">=</span> <span class="token punctuation">{</span>
  VK_STRUCTURE_TYPE_SUBMIT_INFO<span class="token punctuation">,</span>                    <span class="token comment">// VkStructureType                        sType</span>
  <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const void                            *pNext</span>
  <span class="token number">0</span><span class="token punctuation">,</span>                                                <span class="token comment">// uint32_t                               waitSemaphoreCount</span>
  <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const VkSemaphore                     *pWaitSemaphores</span>
  <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">,</span>                                          <span class="token comment">// const VkPipelineStageFlags            *pWaitDstStageMask;</span>
  <span class="token number">1</span><span class="token punctuation">,</span>                                                <span class="token comment">// uint32_t                               commandBufferCount</span>
  <span class="token operator">&amp;</span>command_buffer<span class="token punctuation">,</span>                                  <span class="token comment">// const VkCommandBuffer                 *pCommandBuffers</span>
  <span class="token number">0</span><span class="token punctuation">,</span>                                                <span class="token comment">// uint32_t                               signalSemaphoreCount</span>
  <span class="token keyword keyword-nullptr">nullptr</span>                                           <span class="token comment">// const VkSemaphore                     *pSignalSemaphores</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token function">vkQueueSubmit</span><span class="token punctuation">(</span> <span class="token function">GetGraphicsQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Handle<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>submit_info<span class="token punctuation">,</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token operator">!=</span> VK_SUCCESS <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">vkDeviceWaitIdle</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 45px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 45px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre></div>

<p><strong>7.</strong> <em>Tutorial05.cpp, function CopyVertexData()</em></p>

<p>At the beginning, we get vertex data and map the staging buffer’s memory by calling the <strong>vkMapMemory()</strong>
 function. During the call, we specify a handle of a memory that is 
bound to a staging buffer, and buffer’s size. This gives us a pointer 
that we can use in an ordinary memcpy() function to copy data from our 
application to graphics hardware.</p>

<p>Next we flush the mapped memory to tell the driver which parts of a 
memory object were modified. We can specify multiple ranges of memory if
 needed. We have one memory area that should be flushed and we specify 
it by creating a variable of type VkMappedMemoryRange and by calling a <strong>vkFlushMappedMemoryRanges()</strong>
 function. After that we unmap the memory, but we don’t have to do this.
 We can keep a pointer for later use and this should not affect the 
performance of our application.</p>

<p>Next we start preparing a command buffer. We specify that it will be 
submitted only once before it will be reset. We fill a 
VkCommandBufferBeginInfo structure and provide it to a <strong>vkBeginCommandBuffer()</strong> function.</p>

<p>Now we perform the copy operation. First a variable of type VkBufferCopy is created. It contains the following fields:</p>

<ul>
	<li>srcOffset – Offset in bytes in a source buffer from which we want to copy data.</li>
	<li>dstOffset – Offset in bytes in a destination buffer into which we want to copy data.</li>
	<li>size – Size of the data (in bytes) we want to copy.</li>
</ul>

<p>We copy data from the beginning of a staging buffer and to the 
beginning of a vertex buffer, so we specify zero for both offsets. The 
size of the vertex buffer was calculated based on the hard-coded vertex 
data, so we copy the same number of bytes. To copy data from one buffer 
to another, we call a <strong>vkCmdCopyBuffer()</strong> function.</p>

<h3>Setting a Buffer Memory Barrier<a class="inpage-nav-anchor" id="inpage-nav-3-undefined"></a></h3>

<p>We have recorded a copy operation but that’s not all. From now on we 
will not use the buffer as a target for transfer operations but as a 
vertex buffer. We need to tell the driver that the type of buffer’s 
memory access will change and from now on it will serve as a source of 
data for vertex attributes. To do this we set a memory barrier similarly
 to what we have done earlier in case of swapchain images.</p>

<p>First we prepare a variable of type VkBufferMemoryBarrier, which contains the following members:</p>

<ul>
	<li>sType – Standard structure type, here set to VK_STRUCTURE_TYPE_BUFFER_MEMORY_BARRIER.</li>
	<li>pNext – Parameter reserved for extensions.</li>
	<li>srcAccessMask – Types of memory operations that were performed on this buffer before the barrier.</li>
	<li>dstAccessMask – Memory operations that will be performed on a given buffer after the barrier.</li>
	<li>srcQueueFamilyIndex – Index of a queue family that accessed the buffer before.</li>
	<li>dstQueueFamilyIndex – Queue family that will access the buffer from now on.</li>
	<li>buffer – Handle to the buffer for which we set up a barrier.</li>
	<li>offset – Memory offset from the start of the buffer (from the memory’s base offset bound to the buffer).</li>
	<li>size – Size of the buffer’s memory area for which we want to setup a barrier.</li>
</ul>

<p>As you can see, we can set up a barrier for a specific range of 
buffer’s memory. But here we do it for the whole buffer, so we specify 
an offset of 0 and the VK_WHOLE_SIZE enum for the size. We don’t want to
 transfer ownership between different queue families, so we use 
VK_QUEUE_FAMILY_IGNORED enum both for srcQueueFamilyIndex and 
dstQueueFamilyIndex.</p>

<p>The most important parameters are srcAccessMask and dstAccessMask. We
 have copied data from the staging buffer to a vertex buffer. So before 
the barrier, the vertex buffer was used as a destination for transfer 
operations and its memory was written to. That’s why we have specified 
VK_ACCESS_MEMORY_WRITE_BIT for a srcAccessMask field. But after that the
 barrier buffer will be used only as a source of data for vertex 
attributes. So for dstAccessMask field we specify 
VK_ACCESS_VERTEX_ATTRIBUTE_READ_BIT.</p>

<p>To set up a barrier we call a <strong>vkCmdPipelineBarrier()</strong> function. And to finish command buffer recording, we call <strong>vkEndCommandBuffer()</strong>. Next, for all of the above operations to execute, we submit a command buffer by calling <strong>vkQueueSubmit()</strong> function.</p>

<p>Normally during the command buffer submission, we should provide a 
fence. It is signaled once all transfer operations (and whole command 
buffer) are finished. But here, for the sake of simplicity, we call <strong>vkDeviceWaitIdle()</strong>
 and wait for all operations executed on a given device to finish. Once 
all operations complete, we have successfully transferred data to the 
device-local memory and we can use the vertex buffer without worrying 
about performance loss.</p>

<h2>Tutorial05 Execution<a class="inpage-nav-anchor" id="inpage-nav-4"></a></h2>

<p>The results of the rendering operations are exactly the same as in Part 4:</p>

<p style="text-align:center"><img alt="" src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/vulkan-part-4-image-01-result-of-rendering-673812.png"></p>

<p>We render a quad that has different colors in each corner: red, 
green, dark gray, and blue. The quad should adjust its size (and aspect)
 to match window’s size and shape.</p>

<h2>Cleaning Up<a class="inpage-nav-anchor" id="inpage-nav-5"></a></h2>

<p>In this part of the tutorial, I have also refactored the cleaning 
code. We have created two buffers, each with a separate memory object. 
To avoid code redundancy, I prepared a buffer cleaning function:</p>
<div class="code-toolbar"><pre class=" language-cpp line-numbers"><div class="toolbar" style="float: right;"><div class="toolbar-item"><a>Copy Code</a></div></div><code class=" language-cpp"><span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> buffer<span class="token punctuation">.</span>Handle <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">vkDestroyBuffer</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> buffer<span class="token punctuation">.</span>Handle<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  buffer<span class="token punctuation">.</span>Handle <span class="token operator">=</span> VK_NULL_HANDLE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> buffer<span class="token punctuation">.</span><span class="token type-opencl-host-c++ keyword">Memory</span> <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">vkFreeMemory</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> buffer<span class="token punctuation">.</span><span class="token type-opencl-host-c++ keyword">Memory</span><span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  buffer<span class="token punctuation">.</span><span class="token type-opencl-host-c++ keyword">Memory</span> <span class="token operator">=</span> VK_NULL_HANDLE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre></div>

<p><strong>8.</strong> <em>Tutorial05.cpp, function DestroyBuffer()</em></p>

<p>This function checks whether a given buffer was successfully created, and if so it calls a <strong>vkDestroyBuffer()</strong> function. It also frees memory associated with a given buffer through a <strong>vkFreeMemory()</strong>
 function call. The DestroyBuffer() function is called in a destructor 
that also releases all other resources relevant to this part of the 
tutorial:</p>
<div class="code-toolbar"><pre class=" language-cpp line-numbers"><div class="toolbar" style="float: right;"><div class="toolbar-item"><a>Copy Code</a></div></div><code class=" language-cpp"><span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">vkDeviceWaitIdle</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">DestroyBuffer</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>VertexBuffer <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">DestroyBuffer</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>StagingBuffer <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>GraphicsPipeline <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">vkDestroyPipeline</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>GraphicsPipeline<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    Vulkan<span class="token punctuation">.</span>GraphicsPipeline <span class="token operator">=</span> VK_NULL_HANDLE<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>RenderPass <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">vkDestroyRenderPass</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>RenderPass<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    Vulkan<span class="token punctuation">.</span>RenderPass <span class="token operator">=</span> VK_NULL_HANDLE<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword keyword-for">for</span><span class="token punctuation">(</span> size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Framebuffer <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">vkDestroyFramebuffer</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Framebuffer<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CommandBuffer <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">vkFreeCommandBuffers</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>CommandPool<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CommandBuffer <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ImageAvailableSemaphore <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">vkDestroySemaphore</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ImageAvailableSemaphore<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>FinishedRenderingSemaphore <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">vkDestroySemaphore</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>FinishedRenderingSemaphore<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Fence <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">vkDestroyFence</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>RenderingResources<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Fence<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span> Vulkan<span class="token punctuation">.</span>CommandPool <span class="token operator">!=</span> VK_NULL_HANDLE <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">vkDestroyCommandPool</span><span class="token punctuation">(</span> <span class="token function">GetDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Vulkan<span class="token punctuation">.</span>CommandPool<span class="token punctuation">,</span> <span class="token keyword keyword-nullptr">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    Vulkan<span class="token punctuation">.</span>CommandPool <span class="token operator">=</span> VK_NULL_HANDLE<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span><span style="height: 22.5px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre></div>

<p><strong>9.</strong> <em>Tutorial05.cpp, destructor</em></p>

<p>First we wait for all the operations performed by the device to 
finish. Next we destroy the vertex and staging buffers. After that we 
destroy all other resources in the order opposite to their creation: 
graphics pipeline, render pass, and resources for each <em>virtual frame,</em>
 which consists of a framebuffer, command buffer, two semaphores, a 
fence, and a framebuffer. Finally we destroy a command pool from which 
command buffers were allocated.</p>

<h2>Conclusion<a class="inpage-nav-anchor" id="inpage-nav-6"></a></h2>

<p>In this tutorial we used the recommended technique for transferring 
data from the application to the graphics hardware. It gives the best 
performance for the resources involved in the rendering process and the 
ability to map and copy data from the application to the staging buffer.
 We only need to prepare an additional command buffer recording and 
submission to transfer data from one buffer to another.</p>

<p>Using staging buffers is recommended for more than just copying data 
between buffers. We can use the same approach to copy data from a buffer
 to images. And the next part of the tutorial will show how to do this 
by presenting the descriptors, descriptor sets, and descriptor layouts, 
which are another big part of the Vulkan API.</p>

<p><strong>Next up: <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/develop/articles/api-without-secrets-introduction-to-vulkan-part-6.html">API without Secrets: Introduction to Vulkan* Part 6</a></strong></p>

<p>This sample source code is released under the <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/en-us/articles/intel-sample-source-code-license-agreement/">Intel Sample Source Code License Agreement</a>.</p>
<p></p>
    </div>
</div>
<div class="clearfix"></div>
<div class="ct-outer-table">
    
</div>
</div>

<div class="idzRelatedContent">












































</div>

<div class="bladepar intelparsys">
</div>


    <div class="hidden">
    <sup>1</sup></div>
    <div class="disclaimer parbase editorial-disclaimer">












    
    
        
        
        
            <div class="disclaimer-component">
                <div class="container">
                    <h4>Product and Performance Information</h4>
                    
                    
                    
                        
                            <div class="disclaimer"><sup>1</sup><p>Intel's
 compilers may or may not optimize to the same degree for non-Intel 
microprocessors for optimizations that are not unique to Intel 
microprocessors. These optimizations include SSE2, SSE3, and SSSE3 
instruction sets and other optimizations. Intel does not guarantee the 
availability, functionality, or effectiveness of any optimization on 
microprocessors not manufactured by Intel. Microprocessor-dependent 
optimizations in this product are intended for use with Intel 
microprocessors. Certain optimizations not specific to Intel 
microarchitecture are reserved for Intel microprocessors. Please refer 
to the applicable product User and Reference Guides for more information
 regarding the specific instruction sets covered by this notice.</p>
<p>Notice revision #20110804</p>
</div>
                        
                    
                    
                </div>
            </div>
        
    

</div>


<div class="idzRateUs parbase">








<div class="rate-us-container">
    <div class="idz-survey">
        <div class="rate-us">
            <section class="blade blade-support-featured-content blade-featured-content solid theme-dark-1 no-print">
                <input type="hidden" id="hostname" value="/feedback/uri">
                <div class="container">
                    <div class="support-options">
                        <div class="blade-support-feedback">
                            <div class="container">
                                <div class="row">
                                    <div class="col-sm-10 rateUs-title text-left">
                                        <figure>
                                            <span class="feedback-icon"></span>
                                        </figure>
                                        <h2>Give Feedback</h2>
                                        <h2 class="feedback-close-btn"></h2>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix visible-xs space-xs"></div>
                </div>
            </section>
        </div>
        <div class="iframe-survey">
            <div class="iframe-form"><iframe src="https://web.archive.org/web/20200917044707if_/https://intel.az1.qualtrics.com/jfe/form/SV_eai43JosW74IFxz?Q_JFE=qdg" data-ruffle-polyfilled=""></iframe></div>
        </div>
    </div>
</div>
</div>

<script src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/prism.js"></script>

    
        <div id="contextualFooter-PlaceHolder" class="contextualFooter"></div>
    



































<footer class="global blade solid brand-lighter-gray theme-light-2 component" data-component-id="1" data-component="footer" role="contentinfo" data-wap_type="wa_skip_track" id="skip-footer">
    <div class="container">
        <div class="content-footer">
            <div class="content">
                
                    
                        
                            <ul class="footer-links">
                                
                                    <li>
                                        <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/company-overview/company-overview.html">Company Information</a>
                                    </li>
                                
                                    <li>
                                        <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/corporate-responsibility/corporate-responsibility.html">Our Commitment</a>
                                    </li>
                                
                                    <li>
                                        <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/blogs-communities-social.html">Communities </a>
                                    </li>
                                
                                    <li>
                                        <a href="https://web.archive.org/web/20200917044707/https://www.intc.com/investor-relations/default.aspx">Investor Relations</a>
                                    </li>
                                
                                    <li>
                                        <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/company-overview/contact-us.html">Contact Us</a>
                                    </li>
                                
                                    <li>
                                        <a href="https://web.archive.org/web/20200917044707/https://newsroom.intel.com/">Newsroom</a>
                                    </li>
                                
                                    <li>
                                        <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/jobs/jobs-at-intel.html"> Jobs</a>
                                    </li>
                                
                            </ul>
                        
                        
                        
                    
                
                    
                        
                        
                            <ul class="footer-links social">
                                
                                    <li>
                                        
                                            
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://www.facebook.com/Intel" target="" aria-label="Intel on Facebook" data-wap="{&quot;linktype&quot;:&quot;footersocial&quot;}">
                                                    <i aria-hidden="true" class="fa-facebook"></i>
                                                </a>
                                            
                                        
                                    </li>
                                
                                    <li>
                                        
                                            
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://twitter.com/intel" target="" aria-label="Intel on Twitter" data-wap="{&quot;linktype&quot;:&quot;footersocial&quot;}">
                                                    <i aria-hidden="true" class="fa-twitter"></i>
                                                </a>
                                            
                                        
                                    </li>
                                
                                    <li>
                                        
                                            
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://www.linkedin.com/company/intel-corporation" target="" aria-label="Intel on LinkedIn" data-wap="{&quot;linktype&quot;:&quot;footersocial&quot;}">
                                                    <i aria-hidden="true" class="fa-linkedin"></i>
                                                </a>
                                            
                                        
                                    </li>
                                
                                    <li>
                                        
                                            
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://www.youtube.com/user/channelintel?sub_confirmation=1" target="" aria-label="Intel on YouTube" data-wap="{&quot;linktype&quot;:&quot;footersocial&quot;}">
                                                    <i aria-hidden="true" class="fa-youtube"></i>
                                                </a>
                                            
                                        
                                    </li>
                                
                                    <li>
                                        
                                            
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://www.instagram.com/intel/" target="" aria-label="Intel on Instagram" data-wap="{&quot;linktype&quot;:&quot;footersocial&quot;}">
                                                    <i aria-hidden="true" class="fa-instagram"></i>
                                                </a>
                                            
                                        
                                    </li>
                                
                            </ul>
                        
                        
                    
                
                    
                        
                        
                        
                            <ul class="footer-links secondary-links" id="footerSecondaryLinks">
                                
                                    <li>
                                        
                                            
                                            
                                                <small>© Intel Corporation</small>
                                            
                                        
                                    </li>
                                
                                    <li>
                                        
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/legal/terms-of-use.html">
                                                    <small>Terms of Use</small>
                                                </a>
                                            
                                            
                                        
                                    </li>
                                
                                    <li>
                                        
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/legal/trademarks.html">
                                                    <small>*Trademarks</small>
                                                </a>
                                            
                                            
                                        
                                    </li>
                                
                                    <li>
                                        
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/privacy/intel-privacy-notice.html">
                                                    <small>Privacy</small>
                                                </a>
                                            
                                            
                                        
                                    </li>
                                
                                    <li>
                                        
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/privacy/intel-cookie-notice.html">
                                                    <small>Cookies</small>
                                                </a>
                                            
                                            
                                        
                                    </li>
                                
                                    <li>
                                        
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/corporate-responsibility/statement-combating-modern-slavery.html">
                                                    <small>Supply Chain Transparency </small>
                                                </a>
                                            
                                            
                                        
                                    </li>
                                
                                    <li>
                                        
                                            
                                                <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/siteindex.html">
                                                    <small>Site Map</small>
                                                </a>
                                            
                                            
                                        
                                    </li>
                                
                            </ul>
                        
                    
                
            </div>
            <div class="logo-container">
                <a href="https://web.archive.org/web/20200917044707/https://software.intel.com/content/www/us/en/homepage.html" class="footer-logo-rebrand" aria-label="Intel Footer Logo" title="Intel Footer Logo">
                    <img src="API%20without%20Secrets_%20Introduction%20to%20Vulkan_%20Part%205_files/intel-footer-logo.svg" class="footer-logo-rebrand" alt="Intel Footer Logo" title="Intel Footer Logo">
                </a>
            </div>
        </div>
    </div>
</footer>












    <textarea id="defers" title="" style="display:none;">    
        &lt;script&gt;var isTargetEnabled =false;&lt;/script&gt;
        
        
            















    
    
        
        
        
        
        
        
        
    




    
    
        
    




    
    
    
    
        
    

&lt;script type="text/javascript"&gt;
    var cq_tms = {
        wa_emtcontenttype: "emtcontenttype:webpage/article",
        wa_emttechnology: 
"emttechnology:inteltechnologies/
intelgraphicsandvisualtechnologies,emttechnology:thirdpartytechnologies/
vulkan",
        wa_emtsubject: 
"emtsubject:itinformationtechnology/visualcomputing/
videogamedevelopment",
        
        wa_industry_type: "",
        wa_partner_prog: "",
        wa_subject: 
"emtsubject:itinformationtechnology/visualcomputing/
videogamedevelopment",
        wa_biz_size: "",
        wa_emt_org: "",
        wa_emt_intel: "",
        wa_partner_type: "",
        wa_programidentifier: "",
        wa_location: "us",
        wa_language: "en",
        wa_english_title: "API without Secrets: Introduction to Vulkan* 
Part 5",
        wa_content_type: "article",
        wa_intel_platform: "",
        wa_applications: "",
        wa_local: "en_US",
        wa_intel_technology: 
"emttechnology:inteltechnologies/
intelgraphicsandvisualtechnologies,emttechnology:thirdpartytechnologies/
vulkan",
        wa_system_type: "",
        wa_product_name: "",
        wa_audience: 
"emtaudience:business/btssbusinesstechnologysolutionspecialist/
softwaredeveloper",
        wa_life_cycle: "",
        wa_cq_url: 
"/content/www/us/en/develop/articles/api-without-secrets-introduction-
to-vulkan-part-5.html",
        wa_page_type_micro: "editorialposttemplate",
        wa_env: "prd",
        wa_cq_pub_env: "publish",
        wa_transl_status: "",
        wa_product_id: "",
        wa_software: "",
        wa_reference_design: "",
        wa_codename: "",
        wa_created_date: "1587983862719",
        wa_modifed_date: "1586858330952",
        wa_off_time: "1633704899026",
        wa_ownedby: "",
        wa_managedby: "",
        wa_idz_nid : "673812",
        wa_event_type: "",
        wa_idz_custom_tags: "",
        wa_programming_language: "",
        wa_skill_level: "",
        wa_solution: "",
        wa_product_formFactor: "",
        wa_operating_system: "",
        wa_marketing_products: "",
        wa_ssg_third_party_prod_sys_sol: "",
        
        wa_secondary_content_type: ""
    };
    
    
    
    cq_tms.wa_tms_sync_load = "deferred";
    
&lt;/script&gt;





    &lt;script type="text/javascript" 
src="/web/20200917044707js_/https://software.intel.com/content/dam/www/
global/wap/tms.sync.js" async&gt;&lt;/script&gt;


        
    
    &lt;link rel="stylesheet" 
href="/web/20200917044707cs_/https://software.intel.com/etc.clientlibs/
settings/wcm/designs/ver/8.0.00.50/intel/clientlibs/pages/commons-
page.min.css" type="text/css"&gt;&lt;script 
src="/web/20200917044707js_/https://software.intel.com/etc.clientlibs/
settings/wcm/designs/ver/8.0.00.50/intel/clientlibs/pages/commons-
page.min.js" defer&gt;&lt;/script&gt;


&lt;script&gt;!function(){var 
e=setInterval(function(){"undefined"!=typeof 
$CQ&amp;&amp;($CQ(function(){CQ_Analytics.SegmentMgr.loadSegments("/etc/
segmentation"),CQ_Analytics.ClientContextUtils.init("/etc/clientcontext/
intel",window.location.pathname.substr(0,window.location.pathname.indexOf(".")))}),clearInterval(e))},100)}
();&lt;/script&gt;










&lt;link rel="stylesheet" type="text/css" 
href="/web/20200917044707cs_/https://software.intel.com/etc.clientlibs/
settings/wcm/designs/intel/us/en/css/resources/css/
intel.rwd.override.css"/&gt;

</textarea>







<deepl-input-controller translate="no"></deepl-input-controller></body></html>
<!--
     FILE ARCHIVED ON 04:47:07 Sep 17, 2020 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 21:54:19 Sep 10, 2025.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.669
  exclusion.robots: 0.031
  exclusion.robots.policy: 0.02
  esindex: 0.012
  cdx.remote: 8.516
  LoadShardBlock: 110.404 (3)
  PetaboxLoader3.datanode: 127.872 (4)
  load_resource: 131.941
  PetaboxLoader3.resolve: 56.393
-->